<Application x:Class="AnimeStudio.GUIV2.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:AnimeStudio.GUIV2"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <ResourceDictionary>
            <Style x:Key="BaseWindowStyle" TargetType="Window">
                <Setter Property="WindowStyle" Value="None"/>
                <Setter Property="ResizeMode" Value="CanResize"/>
                <Setter Property="Background" Value="#1E1E1E"/>
                <Setter Property="AllowsTransparency" Value="False"/>

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Window">
                            <Border x:Name="OuterBorder"
                            BorderThickness="1"
                            BorderBrush="Transparent"
                            Background="{TemplateBinding Background}">

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="32"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>

                                    <!-- Title Bar -->
                                    <Border Background="#2D2D30"
                                    Grid.Row="0">

                                        <DockPanel LastChildFill="True">

                                            <TextBlock Text="{TemplateBinding Title}"
                                               VerticalAlignment="Center"
                                               Margin="10,0"
                                               Foreground="White"/>

                                            <StackPanel Orientation="Horizontal"
                                                DockPanel.Dock="Right">

                                                <Button Content="—"
                                                Width="45"
                                                Style="{StaticResource TitleButtonStyle}"
                                                Command="SystemCommands.MinimizeWindowCommand"/>

                                                <Button Content="☐"
                                                Width="45"
                                                Style="{StaticResource TitleButtonStyle}"/>

                                                <Button Content="✕"
                                                Width="45"
                                                Style="{StaticResource CloseButtonStyle}"
                                                Command="SystemCommands.CloseWindowCommand"/>
                                            </StackPanel>
                                        </DockPanel>
                                    </Border>

                                    <!-- Content -->
                                    <AdornerDecorator Grid.Row="1">
                                        <ContentPresenter/>
                                    </AdornerDecorator>

                                </Grid>
                            </Border>

                            <!-- Blue outline when NOT maximized -->
                            <ControlTemplate.Triggers>
                                <Trigger Property="WindowState" Value="Normal">
                                    <Setter TargetName="OuterBorder"
                                    Property="BorderBrush"
                                    Value="#007ACC"/>
                                </Trigger>

                                <Trigger Property="WindowState" Value="Maximized">
                                    <Setter TargetName="OuterBorder"
                                    Property="BorderBrush"
                                    Value="Transparent"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Icons/Icons.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/ControlzEx;component/Themes/Generic.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Application.Resources>
</Application>
